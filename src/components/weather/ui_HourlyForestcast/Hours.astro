---
// 1. Importamos el componente que decide qué imagen mostrar
import WeatherIcon from "./WeatherIcon.astro";

interface Props {
    hourly: {
        time: string[];
        temperature_2m: number[];
        weather_code: number[];
    };
}

const { hourly } = Astro.props;

// LOGICA SIMPLE:
// Como el padre ya filtró el día correcto, hourly.time[0] es la primera hora de ese día.
// Solo cortamos (.slice) las primeras 8 para que no se haga una lista infinita.
const horasParaMostrar = hourly.time.slice(0, 8).map((time, i) => {
    return {
        // Formateamos la hora
        horaLegible: new Date(time).toLocaleTimeString("es-ES", {
            hour: "2-digit",
            minute: "2-digit",
        }),
        // Usamos el índice 'i' directo porque los arrays están sincronizados
        temperatura: Math.round(hourly.temperature_2m[i]),
        codigoClima: hourly.weather_code[i],
    };
});
---

<div class="flex flex-col gap-3 p-2">
    {
        horasParaMostrar.map((item) => (
            <div class="flex flex-row items-center justify-between p-1 theme-card">
                <div class="flex flex-row items-center gap-2 text-white">
                    <WeatherIcon
                        code={item.codigoClima}
                        class="w-10 h-10 mb-2"
                    />
                    <span class="text-sm font-light">{item.horaLegible}</span>
                </div>
                <span class="text-xl font-semibold text-white">
                    {item.temperatura}°
                </span>
            </div>
        ))
    }
</div>
